# SSL Certificate
## What is TLS

**TLS**는 **SSL** 기반이며, SSLv3의 알려진 취약성에 대응한 대체품으로서 개발되었다.

SSL은 일반적으로 사용되는 용어이며, 요즘에는 일반적으로 TLS를 나타낸다.

## Security Provided

SSL/TLS는 데이터 암호화, 데이터 무결성 및 인증을 제공한다.

즉, SSL/TLS를 사용하는 경우 다음을 확신할 수 있다.

- 아무도 메시지를 읽지 않았다.
- 아무도 메시지를 변경하지 않았다.
- 의도한 사람(서버)과 통신 중이다.

두 사람 간에 메시지를 보낼 때 해결해야 할 두 문제가 있다.

- 아무도 메시지를 읽지 않았다는 걸 어떻게 알까?
- 아무도 메시지를 변경하지 않았다는 걸 어떻게 알까?

이러한 문제의 해결 방법은 다음과 같다.

- **암호화**
    - 이렇게 하면 내용을 읽을 수 없으므로 메시지를 보는 모든 사람이 이해할 수 없다.
- **서명**
    - 메시지를 보낸 사람이 본인이며, 메시지가 변경되지 않았음을 수신인이 확신할 수 있다.

이 두 프로세스 모두 키를 사용해야 한다.

이러한 키는 단순한 숫자(일반적으로 128비트인 경우)로, 메시지를 암호화하거나 서명하기 위해 일반적으로 알고리즘(예: RSA)으로 알려진 특정 방법을 사용하여 메시지와 결합된다.

## Symmetrical Keys and Public and Private Keys

오늘날 사용되는 거의 모든 암호화 방법은 **공개키** 및 **개인키**를 사용한다.
이들은 이전의 대칭키 배열보다 훨씬 더 안전한 것으로 간주된다.

대칭키를 사용하면 메시지를 암호화하거나 서명하는 데 키가 사용되며, 메시지의 암호를 해독하는 데에도 **동일한 키**가 사용된다.

이는 우리가 일상 생활에서 다루는 열쇠와 같다.

이러한 유형의 키 배열에서 문제는 키를 잃어버린 경우 키를 발견한 모든 사용자가 문을 열 수 있다는 것이다.

**공개키와 개인키**를 사용하면 수학적으로 관련이 있지만 (**키 쌍**으로 속함) 서로 다른 두 개의 키가 사용된다.

이는 **공개키로 암호화**된 메시지를 **동일한 공개키로 해독할 수 없음**을 의미한다.

메시지의 암호를 해독하려면 **개인키**가 필요하다.

만약 이러한 유형의 키 배열이 자동차와 함께 사용되었다면, 차를 잠그고, 같은 열쇠로는 차의 잠금을 **해제할 수 없기 때문**에 열쇠를 자물쇠에 넣어둘 수 있다.

이러한 유형의 키 배열은 매우 안전하며, 모든 최신 암호화/서명 시스템에 사용된다.

## Keys and SSL Certificates

SSL/TLS는 데이터 암호화 및 데이터 무결성을 위해 **공개키 및 개인키** 시스템을 사용한다.

공개키는 누구나 사용할 수 있으므로 공개(public)라는 용어가 붙는다.
이 때문에 특히 다음과 같은 신뢰 문제가 발생한다. 특정 공개키가 자신이 주장하는 개인/기업에 속한다는 것을 어떻게 알 수 있는가?

예를 들어, 은행에 속해 있다고 주장하는 키를 받게 되었을 때, 그것이 당신의 은행에 속한다는 것을 어떻게 알 수 있을까?

정답은 **디지털 인증서**를 사용하는 것이다.

인증서는 일상 생활에서 여권이 하는 것과 같은 목적을 제공한다.

여권은 사진과 사람 사이를 연결을 설정했으며, 해당 연결은 **신뢰할 수 있는 기관**(여권 사무소)에 의해 확인되었다.

디지철 인증서는 신뢰할 수 있는 제3자(**인증 기관**)에 의해 확인(**서명**)된 **공개키**와 엔티티(비즈니스, 도메인 이름 등) 사이의 링크를 제공한다.

**디지털 인증서**를 사용하면 **신뢰할 수 있는 공개 암호화 키**를 편리하게 배포할 수 있다.

## Obtaining a Digital Certificate

**공인 인증 기관(CA)**에서 디지털 인증서를 발급 받는다. 여권 사무소에서 여권을 발급 받는 것과 같다. 

사실 그 절차는 매우 비슷하다.

적절한 양식을 작성하여 공개키를 (숫자) 추가한 후 인증기관에 보낸다. (**인증서 요청**)

인증 기관에서 일부 검사를 수행하고(권한에 따라 다르다) **인증서**에 동봉된 키를 다시 보낸다.

인증서는 **발급 인증 기관**에서 **서명**하며, 이것이 키를 보증한다.

이제 다른 사용자가 공개키를 원할 때 인증서를 보내고 **인증서의 서명을 확인**하며 인증 확인이 되면 사용자의 **키를 신뢰할 수 있다**.

## Example Usage

설명을 위해 **SSL**(**https**)을 사용하는 일반적인 웹 브라우저 및 웹 서버 연결에 대해 살펴 보겠다. 

1. 브라우저가 서버에 SSL(https)을 사용하여 연결한다.
2. 서버가 웹 서버의 공개키를 포함하는 서버 인증서로 응답한다.
3. 브라우저는 CA의 서명을 확인하여 인증서를 확인한다. 이렇게 하려면 **CA 인증서**가 브라우저의 신뢰할 수 있는 저장소에 있어야 한다. (나중에 참조)
4. 브라우저는 이 공개키를 사용하여 **세션 키**를 서버와 합의한다.
5. 웹 브라우저 및 서버는 **세션 키**를 사용하여 연결을 통해 데이터를 암호화한다.

## Digital Certificate Types

웹 사이트용 인증서를 구입하거나 MQTT 암호화에 사용하려는 경우 두 가지 주요 유형이 있다.

- Domain Validated Certificates (DVC)
- Extended validation Ceritficates (EVC)

두 가지 유형의 차이점은 보다 엄격한 유효성 검사와 함께 제공되는 인증서의 신뢰 정도이다.

제공하는 암호화 수준은 동일하다.

**도메인 유효성 검사 인증서(DV)**는 DNS 도메인에 대한 일부 제어를 증명함으로써 신청자의 ID가 검증된 전송 계층 보안(TLS)에 일반적으로 사용되는 **X.509 디지털 인증서**이다.

유효성 검사 프로세스는 일반적으로 완전히 자동화되어 가장 저렴한 형태의 인증서이다. 콘텐츠를 제공하는 웹 사이트에서 사용하기에 이상적이며 중요한 데이터에는 사용되지 않는다.

**EV(Extended Validation Certificate)**는 웹 사이트 또는 소프트웨어 패키지를 제어하는 법인을 증명하는 **HTTPS 웹 사이트** 및 소프트웨어에 사용되는 인증서이다. **EV 인증서**를 얻으려면 인증 기관(CA)에서 요청하는 엔티티의 신원을 확인해야 한다.

일반적으로 도메인 유효성 검사 인증서보다 비용이 더 많이 든다. 수동 검증이 필요하기 때문이다.

## Certificate Usage Restrictions- Wildcards and SANs

일반적으로 인증서는 하나의 **FQDN**(정규화된 단일 도메인 이름)에서 사용할 수 있다.

**www.mydomain.com**에서 사용하기 위해 구입된 인증서로 **mail.mydomain.com** 또는 **www.otherdomain.com**에서 사용할 수 없다.

그러나 여러 하위 도메인(subdomain)과 기본 도메인(main domain) 이름을 보호해야 하는 경우 **와일드카드 인증서**를 구입할 수 있다.

와일드카드 인증서는 특정 도메인 이름 아래의 **모든 하위 도메인**을 포함한다.

예를 들어, ***.mydomain.com**에 대한 와일드카드 인증서를 사용할 수 있다.

- mail.mydomain.com
- www.mydomain.com
- ftp.mydomain.com
- etc

이는 **mydomain.com**과 **myotherdomain.com**을 모두 보호하는 데 사용할 수는 없다.

단일 인증서의 여러 도메인 이름을 포함하려면 **SAN(Subject Alternate Name)**이 포함된 인증서를 구입해야 한다.

일반적으로 기본 도메인 이름 외에도 4개의 추가 도메인 이름을 보호할 수 있다. 예를 들어 다음과 같은 경우 동일한 인증서를 사용할 수 있다.

- www.mydomain.com
- www.mydomain.org
- www.mydomain.net
- www.mydomain.co
- www.mydomain.co.uk

도메인 이름을 변경할 수도 있지만 그 경우, 인증서를 다시 발급해야 한다.

## Why use Commercial Certificates?

## Certificate Encodings and Files Extensions


## Reference
- http://www.steves-internet-guide.com/ssl-certificates-explained/